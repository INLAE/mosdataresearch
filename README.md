

## Этот проект позволяет

1. Собрать список датаcетов категории Дороги и транспорт (ID 102) с `data.mos.ru`.
2. Отфильтровать те, что содержат метро / МЦД / МЦК / диаметр / кольц… в названии, и сохранить их описание в файл `datasets_info.txt`.
3. Для каждого из таких датаcетов автоматически создать в PostgreSQL(PostGIS) отдельную таблицу `dataset_{ID}_{slug}` (где `slug` — «фрагмент» из имени датаcета) и загрузить все GeoJSON-фичи из эндпоинта `/v1/features/{datasetId}`.
В результате в бд появится по одной таблице на каждый метро-датаcет, с колонками, соответствующими полям из метаданных. Если в полях есть `Longitude_WGS84` и `Latitude_WGS84`, дополнительно создается колонка `geom` (тип `geometry(Point,4326)`), в которую записывается точка.

## Логика работы 

1. **Анализ датаcетов**  
   - Сначала система запрашивает у сервиса `data.mos.ru` полный список датаcетов, относящихся к категории Дороги и транспорт;  
   - Затем из этого списка отбираются только те датаcеты, в названии которых встречаются ключевые слова (согласно задаче - метро, МЦД, МЦК, диаметр, кольцо).  
   - Для каждого найденного датаcета формируется краткий отчет: его идентификатор, название и перечень полей (наборов данных).

2. **Создание таблиц в бд**  
   - Для каждого отфильтрованного датаcета автоматически создается своя таблица в бд PostGIS;
   - Структура таблицы соответствует полям датаcета - каждый атрибут превращается в колонку с подходящим типом (текст, число, JSON и тд);  
   - Если среди полей датаcета есть координаты (широта/долгота), дополнительно создается колонка для хранения геометрии (точка).

3. **Доп. загрузка геопризнаков**  
   - После создания таблицы система запрашивает у API все записи (фичи) данного датаcета в формате geoJSON; 
   - Каждая запись содержит свойства (атрибуты) и геометрию;
   - Атрибуты преобразуются в строки или числа согласно типу, а вложенные структуры (словарные или справочники) сохраняются в формате JSON внутри одной колонки;  
   - Геометрические координаты (широта/долгота) преобразуются в объект Point и записываются в колонку с геометрией.

4. **Вставка данных**  
   - Все записи одного датаcета вставляются в соответствующую таблицу одной групповой операцией;
   - После загрузки данных таблица полностью готова для запросов и анализа.


## Структура репозитория
````
├── parser.py           # собирает список датасетов и их метаданные
├── importer.py         # создает таблицы и загружает данные
├── main.py             # просто точка запуска: сначала parser, потом importer
├── docker-compose.yml  # запуск pg (postgis) в docker
├── datasets_info.txt   # файл-отчет
└── README.md   
````


